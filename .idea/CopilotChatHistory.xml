<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotChatHistory">
    <option name="conversations">
      <list>
        <Conversation>
          <option name="createTime" value="1750140307754" />
          <option name="id" value="01977c7dc92a7679a69b2a05aa7c6480" />
          <option name="title" value="新对话 2025年6月17日 14:05:07" />
          <option name="updateTime" value="1750140307754" />
        </Conversation>
        <Conversation>
          <option name="createTime" value="1750140190470" />
          <option name="id" value="01977c7c08897bbead8f576ad3f0e7ec" />
          <option name="title" value="com.hmall.trade.domin中创建软件包po" />
          <option name="turns">
            <list>
              <Turn>
                <option name="agent" value="" />
                <option name="answer" value="请添加文件到工作集，因为需要创建新的软件包 `xln.snzoo.gizwv.wlnrm.kl`，但当前没有给出具体要创建的文件内容。若后续明确要创建的文件，可按格式提供文件路径和代码内容。" />
                <option name="chatResource" value="user" />
                <option name="codeReferences">
                  <list />
                </option>
                <option name="codebaseContextVariableValues">
                  <list>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/controller/UserController.java: package com.hmall.user.controller;&#10;import com.hmall.user.domin.dto.LoginFormDTO;&#10;import com.hmall.user.domin.vo.UserLoginVO;&#10;import com.hmall.user.service.IUserService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiImplicitParam;&#10;import io.swagger.annotations.ApiImplicitParams;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.validation.annotation.Validated;&#10;import org.springframework.web.bind.annotation.*;&#10;@Api(tags = &quot;用户相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/users&quot;)&#10;@RequiredArgsConstructor&#10;public class UserController {&#10;    private final IUserService userService;&#10;    @ApiOperation(&quot;用户登录接口&quot;)&#10;    @PostMapping(&quot;login&quot;)&#10;    public UserLoginVO login(@RequestBody @Validated LoginFormDTO loginFormDTO){&#10;        return userService.login(loginFormDTO);&#10;    }&#10;    @ApiOperation(&quot;扣减余额&quot;)&#10;    @ApiImplicitParams({&#10;            @ApiImplicitParam(name = &quot;pw&quot;, value = &quot;支付密码&quot;),&#10;            @ApiImplicitParam(name = &quot;amount&quot;, value = &quot;支付金额&quot;)&#10;    })&#10;    @PutMapping(&quot;/money/deduct&quot;)&#10;    public void deductMoney(@RequestParam(&quot;pw&quot;) String pw,@RequestParam(&quot;amount&quot;) Integer amount){&#10;        userService.deductMoney(pw, amount);&#10;    }&#10;}" />
                      <option name="filePath" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/controller/UserController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="37" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="user-service/src/main/java/com/hmall/user/controller/UserController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="cart-service/src/main/java/com/hmall/cart/controller/CartController.java: package com.hmall.cart.controller;&#10;import com.hmall.cart.domin.dto.CartFormDTO;&#10;import com.hmall.cart.domin.po.Cart;&#10;import com.hmall.cart.domin.vo.CartVO;&#10;import com.hmall.cart.service.ICartService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiImplicitParam;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.apache.ibatis.annotations.Param;&#10;import org.springframework.web.bind.annotation.*;&#10;import javax.validation.Valid;&#10;import java.util.List;&#10;@Api(tags = &quot;购物车相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/carts&quot;)&#10;@RequiredArgsConstructor&#10;public class CartController {&#10;    private final ICartService cartService;&#10;    @ApiOperation(&quot;添加商品到购物车&quot;)&#10;    @PostMapping&#10;    public void addItem2Cart(@Valid @RequestBody CartFormDTO cartFormDTO){&#10;        cartService.addItem2Cart(cartFormDTO);&#10;    }&#10;    @ApiOperation(&quot;更新购物车数据&quot;)&#10;    @PutMapping&#10;    public void updateCart(@RequestBody Cart cart){&#10;        cartService.updateById(cart);&#10;    }&#10;    @ApiOperation(&quot;删除购物车中商品&quot;)&#10;    @DeleteMapping(&quot;{id}&quot;)&#10;    public void deleteCartItem(@Param (&quot;购物车条目id&quot;)@PathVariable(&quot;id&quot;) Long id){&#10;        cartService.removeById(id);" />
                      <option name="filePath" value="$PROJECT_DIR$/cart-service/src/main/java/com/hmall/cart/controller/CartController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="40" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="cart-service/src/main/java/com/hmall/cart/controller/CartController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/CartController.java: package com.hmall.controller;&#10;import com.hmall.domain.dto.CartFormDTO;&#10;import com.hmall.domain.po.Cart;&#10;import com.hmall.domain.vo.CartVO;&#10;import com.hmall.service.ICartService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiImplicitParam;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.apache.ibatis.annotations.Param;&#10;import org.springframework.web.bind.annotation.*;&#10;import javax.validation.Valid;&#10;import java.util.List;&#10;@Api(tags = &quot;购物车相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/carts&quot;)&#10;@RequiredArgsConstructor&#10;public class CartController {&#10;    private final ICartService cartService;&#10;    @ApiOperation(&quot;添加商品到购物车&quot;)&#10;    @PostMapping&#10;    public void addItem2Cart(@Valid @RequestBody CartFormDTO cartFormDTO){&#10;        cartService.addItem2Cart(cartFormDTO);&#10;    }&#10;    @ApiOperation(&quot;更新购物车数据&quot;)&#10;    @PutMapping&#10;    public void updateCart(@RequestBody Cart cart){&#10;        cartService.updateById(cart);&#10;    }&#10;    @ApiOperation(&quot;删除购物车中商品&quot;)&#10;    @DeleteMapping(&quot;{id}&quot;)&#10;    public void deleteCartItem(@Param (&quot;购物车条目id&quot;)@PathVariable(&quot;id&quot;) Long id){&#10;        cartService.removeById(id);&#10;    }&#10;    @ApiOperation(&quot;查询购物车列表&quot;)&#10;    @GetMapping" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/CartController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="44" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/controller/CartController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="item-service/src/main/java/com/hmall/item/controller/ItemController.java: package com.hmall.item.controller;&#10;import com.baomidou.mybatisplus.extension.plugins.pagination.Page;&#10;import com.hmall.common.domain.PageDTO;&#10;import com.hmall.common.domain.PageQuery;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.item.domin.dto.ItemDTO;&#10;import com.hmall.item.domin.dto.OrderDetailDTO;&#10;import com.hmall.item.domin.po.Item;&#10;import com.hmall.item.service.IItemService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.*;&#10;import java.util.List;&#10;@Api(tags = &quot;商品管理相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/items&quot;)&#10;@RequiredArgsConstructor&#10;public class ItemController {&#10;    private final IItemService itemService;&#10;    @ApiOperation(&quot;分页查询商品&quot;)&#10;    @GetMapping(&quot;/page&quot;)&#10;    public PageDTO&lt;ItemDTO&gt; queryItemByPage(PageQuery query) {&#10;        // 1.分页查询&#10;        Page&lt;Item&gt; result = itemService.page(query.toMpPage(&quot;update_time&quot;, false));&#10;        // 2.封装并返回&#10;        return PageDTO.of(result, ItemDTO.class);&#10;    }&#10;    @ApiOperation(&quot;根据id批量查询商品&quot;)" />
                      <option name="filePath" value="$PROJECT_DIR$/item-service/src/main/java/com/hmall/item/controller/ItemController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="36" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="item-service/src/main/java/com/hmall/item/controller/ItemController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/OrderServiceImpl.java: public class OrderServiceImpl extends ServiceImpl&lt;OrderMapper, Order&gt; implements IOrderService {&#10;    private final IItemService itemService;&#10;    private final IOrderDetailService detailService;&#10;    private final ICartService cartService;&#10;    @Override&#10;    @Transactional&#10;    public Long createOrder(OrderFormDTO orderFormDTO) {&#10;        // 1.订单数据&#10;        Order order = new Order();&#10;        // 1.1.查询商品&#10;        List&lt;OrderDetailDTO&gt; detailDTOS = orderFormDTO.getDetails();&#10;        // 1.2.获取商品id和数量的Map&#10;        Map&lt;Long, Integer&gt; itemNumMap = detailDTOS.stream()&#10;                .collect(Collectors.toMap(OrderDetailDTO::getItemId, OrderDetailDTO::getNum));&#10;        Set&lt;Long&gt; itemIds = itemNumMap.keySet();&#10;        // 1.3.查询商品&#10;        List&lt;ItemDTO&gt; items = itemService.queryItemByIds(itemIds);&#10;        if (items == null || items.size() &lt; itemIds.size()) {&#10;            throw new BadRequestException(&quot;商品不存在&quot;);&#10;        }&#10;        // 1.4.基于商品价格、购买数量计算商品总价：totalFee&#10;        int total = 0;&#10;        for (ItemDTO item : items) {&#10;            total += item.getPrice() * itemNumMap.get(item.getId());&#10;        }&#10;        order.setTotalFee(total);&#10;        // 1.5.其它属性&#10;        order.setPaymentType(orderFormDTO.getPaymentType());&#10;        order.setUserId(UserContext.getUser());" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/OrderServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="67" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="37" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/service/impl/OrderServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java: package com.hmall.service.impl;&#10;import com.baomidou.mybatisplus.core.toolkit.IdWorker;&#10;import com.baomidou.mybatisplus.core.toolkit.StringUtils;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.domain.dto.PayApplyDTO;&#10;import com.hmall.domain.dto.PayOrderFormDTO;&#10;import com.hmall.domain.po.Order;&#10;import com.hmall.domain.po.PayOrder;&#10;import com.hmall.enums.PayStatus;&#10;import com.hmall.mapper.PayOrderMapper;&#10;import com.hmall.service.IOrderService;&#10;import com.hmall.service.IPayOrderService;&#10;import com.hmall.service.IUserService;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;import java.time.LocalDateTime;&#10;/**&#10; * &lt;p&gt;&#10; * 支付订单 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; * @since 2023-05-16&#10; */&#10;@Service&#10;@RequiredArgsConstructor&#10;public class PayOrderServiceImpl extends ServiceImpl&lt;PayOrderMapper, PayOrder&gt; implements IPayOrderService {" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="34" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/SearchController.java: package com.hmall.controller;&#10;import cn.hutool.core.util.StrUtil;&#10;import com.baomidou.mybatisplus.extension.plugins.pagination.Page;&#10;import com.hmall.common.domain.PageDTO;&#10;import com.hmall.domain.dto.ItemDTO;&#10;import com.hmall.domain.po.Item;&#10;import com.hmall.domain.query.ItemPageQuery;&#10;import com.hmall.service.IItemService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;@Api(tags = &quot;搜索相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/search&quot;)&#10;@RequiredArgsConstructor&#10;public class SearchController {&#10;    private final IItemService itemService;&#10;    @ApiOperation(&quot;搜索商品&quot;)&#10;    @GetMapping(&quot;/list&quot;)&#10;    public PageDTO&lt;ItemDTO&gt; search(ItemPageQuery query) {&#10;        // 分页查询&#10;        Page&lt;Item&gt; result = itemService.lambdaQuery()&#10;                .like(StrUtil.isNotBlank(query.getKey()), Item::getName, query.getKey())" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/SearchController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="31" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/controller/SearchController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/UserServiceImpl.java: package com.hmall.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.exception.ForbiddenException;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.config.JwtProperties;&#10;import com.hmall.domain.dto.LoginFormDTO;&#10;import com.hmall.domain.po.User;&#10;import com.hmall.domain.vo.UserLoginVO;&#10;import com.hmall.enums.UserStatus;&#10;import com.hmall.mapper.UserMapper;&#10;import com.hmall.service.IUserService;&#10;import com.hmall.utils.JwtTool;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.util.Assert;&#10;/**&#10; * &lt;p&gt;&#10; * 用户表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class UserServiceImpl extends ServiceImpl&lt;UserMapper, User&gt; implements IUserService {&#10;    private final PasswordEncoder passwordEncoder;&#10;    private final JwtTool jwtTool;" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/UserServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="36" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/service/impl/UserServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java: private final IUserService userService;&#10;private final IOrderService orderService;&#10;@Override&#10;public String applyPayOrder(PayApplyDTO applyDTO) {&#10;    // 1.幂等性校验&#10;    PayOrder payOrder = checkIdempotent(applyDTO);&#10;    // 2.返回结果&#10;    return payOrder.getId().toString();&#10;}&#10;@Override&#10;@Transactional&#10;public void tryPayOrderByBalance(PayOrderFormDTO payOrderFormDTO) {&#10;    // 1.查询支付单&#10;    PayOrder po = getById(payOrderFormDTO.getId());&#10;    // 2.判断状态&#10;    if(!PayStatus.WAIT_BUYER_PAY.equalsValue(po.getStatus())){&#10;        // 订单不是未支付，状态异常&#10;        throw new BizIllegalException(&quot;交易已支付或关闭！&quot;);&#10;    }&#10;    // 3.尝试扣减余额&#10;    userService.deductMoney(payOrderFormDTO.getPw(), po.getAmount());&#10;    // 4.修改支付单状态&#10;    boolean success = markPayOrderSuccess(payOrderFormDTO.getId(), LocalDateTime.now());&#10;    if (!success) {&#10;        throw new BizIllegalException(&quot;交易已支付或关闭！&quot;);&#10;    }&#10;    // 5.修改订单状态&#10;    Order order = new Order();&#10;    order.setId(po.getBizOrderNo());&#10;    order.setStatus(2);&#10;    order.setPayTime(LocalDateTime.now());&#10;    orderService.updateById(order);&#10;}&#10;public boolean markPayOrderSuccess(Long id, LocalDateTime successTime) {&#10;    return lambdaUpdate()&#10;            .set(PayOrder::getStatus, PayStatus.TRADE_SUCCESS.getValue())" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="75" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="36" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/ItemServiceImpl.java: package com.hmall.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.domain.dto.ItemDTO;&#10;import com.hmall.domain.dto.OrderDetailDTO;&#10;import com.hmall.domain.po.Item;&#10;import com.hmall.mapper.ItemMapper;&#10;import com.hmall.service.IItemService;&#10;import org.springframework.stereotype.Service;&#10;import java.util.Collection;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; * 商品表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Service&#10;public class ItemServiceImpl extends ServiceImpl&lt;ItemMapper, Item&gt; implements IItemService {&#10;    @Override&#10;    public void deductStock(List&lt;OrderDetailDTO&gt; items) {&#10;        String sqlStatement = &quot;com.hmall.mapper.ItemMapper.updateStock&quot;;&#10;        boolean r = false;&#10;        try {&#10;            r = executeBatch(items, (sqlSession, entity) -&gt; sqlSession.update(sqlStatement, entity));&#10;        } catch (Exception e) {&#10;            throw new BizIllegalException(&quot;更新库存异常，可能是库存不足!&quot;, e);&#10;        }&#10;        if (!r) {&#10;            throw new BizIllegalException(&quot;库存不足！&quot;);&#10;        }" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/ItemServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="37" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/service/impl/ItemServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/ItemController.java: package com.hmall.controller;&#10;import com.baomidou.mybatisplus.extension.plugins.pagination.Page;&#10;import com.hmall.common.domain.PageDTO;&#10;import com.hmall.common.domain.PageQuery;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.domain.dto.ItemDTO;&#10;import com.hmall.domain.dto.OrderDetailDTO;&#10;import com.hmall.domain.po.Item;&#10;import com.hmall.service.IItemService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.*;&#10;import java.util.List;&#10;@Api(tags = &quot;商品管理相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/items&quot;)&#10;@RequiredArgsConstructor&#10;public class ItemController {&#10;    private final IItemService itemService;&#10;    @ApiOperation(&quot;分页查询商品&quot;)&#10;    @GetMapping(&quot;/page&quot;)&#10;    public PageDTO&lt;ItemDTO&gt; queryItemByPage(PageQuery query) {&#10;        // 1.分页查询&#10;        Page&lt;Item&gt; result = itemService.page(query.toMpPage(&quot;update_time&quot;, false));&#10;        // 2.封装并返回&#10;        return PageDTO.of(result, ItemDTO.class);&#10;    }&#10;    @ApiOperation(&quot;根据id批量查询商品&quot;)&#10;    @GetMapping" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/ItemController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="37" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/controller/ItemController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-common/src/main/java/com/hmall/common/utils/CookieBuilder.java:         Cookie cookie = new Cookie(name, URLEncoder.encode(value, charset));&#10;        if(StrUtil.isNotBlank(domain)) {&#10;            cookie.setDomain(domain);&#10;        }else if (request != null) {&#10;            String serverName = request.getServerName();&#10;            serverName = StrUtil.subAfter(serverName, &quot;.&quot;, false);&#10;            cookie.setDomain(&quot;.&quot; + serverName);&#10;        }&#10;        cookie.setHttpOnly(httpOnly);&#10;        cookie.setMaxAge(maxAge);&#10;        cookie.setPath(path);&#10;        log.debug(&quot;生成cookie，编码方式:{}，【{}={}，domain:{};maxAge={};path={};httpOnly={}】&quot;,&#10;                charset.name(), name, value, domain, maxAge, path, httpOnly);&#10;        response.addCookie(cookie);&#10;    }&#10;    /**&#10;     * 利用UTF-8对cookie值解码，避免中文乱码问题&#10;     * @param cookieValue cookie原始值&#10;     * @return 解码后的值&#10;     */&#10;    public String decode(String cookieValue){&#10;        return URLDecoder.decode(cookieValue, charset);&#10;    }&#10;}" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-common/src/main/java/com/hmall/common/utils/CookieBuilder.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="67" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="43" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-common/src/main/java/com/hmall/common/utils/CookieBuilder.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/controller/AddressController.java: package com.hmall.user.controller;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.common.utils.CollUtils;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.user.domin.dto.AddressDTO;&#10;import com.hmall.user.domin.po.Address;&#10;import com.hmall.user.service.IAddressService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import io.swagger.annotations.ApiParam;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; *  前端控制器&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@RestController&#10;@RequestMapping(&quot;/addresses&quot;)&#10;@RequiredArgsConstructor&#10;@Api(tags = &quot;收货地址管理接口&quot;)&#10;public class AddressController {&#10;    private final IAddressService addressService;&#10;    @ApiOperation(&quot;根据id查询地址&quot;)&#10;    @GetMapping(&quot;{addressId}&quot;)" />
                      <option name="filePath" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/controller/AddressController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="38" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="user-service/src/main/java/com/hmall/user/controller/AddressController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="item-service/src/main/java/com/hmall/item/service/impl/ItemServiceImpl.java: package com.hmall.item.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.item.domin.dto.ItemDTO;&#10;import com.hmall.item.domin.dto.OrderDetailDTO;&#10;import com.hmall.item.domin.po.Item;&#10;import com.hmall.item.mapper.ItemMapper;&#10;import com.hmall.item.service.IItemService;&#10;import org.springframework.stereotype.Service;&#10;import java.util.Collection;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; * 商品表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Service&#10;public class ItemServiceImpl extends ServiceImpl&lt;ItemMapper, Item&gt; implements IItemService {&#10;    @Override&#10;    public void deductStock(List&lt;OrderDetailDTO&gt; items) {&#10;        String sqlStatement = &quot;com.hmall.item.mapper.ItemMapper.updateStock&quot;;&#10;        boolean r = false;&#10;        try {&#10;            r = executeBatch(items, (sqlSession, entity) -&gt; sqlSession.update(sqlStatement, entity));&#10;        } catch (Exception e) {&#10;            throw new BizIllegalException(&quot;更新库存异常，可能是库存不足!&quot;, e);&#10;        }" />
                      <option name="filePath" value="$PROJECT_DIR$/item-service/src/main/java/com/hmall/item/service/impl/ItemServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="34" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="item-service/src/main/java/com/hmall/item/service/impl/ItemServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/AddressController.java: package com.hmall.controller;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.common.utils.CollUtils;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.domain.dto.AddressDTO;&#10;import com.hmall.domain.po.Address;&#10;import com.hmall.service.IAddressService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import io.swagger.annotations.ApiParam;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; *  前端控制器&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@RestController&#10;@RequestMapping(&quot;/addresses&quot;)&#10;@RequiredArgsConstructor&#10;@Api(tags = &quot;收货地址管理接口&quot;)&#10;public class AddressController {&#10;    private final IAddressService addressService;&#10;    @ApiOperation(&quot;根据id查询地址&quot;)&#10;    @GetMapping(&quot;{addressId}&quot;)&#10;    public AddressDTO findAddressById(@ApiParam(&quot;地址id&quot;) @PathVariable(&quot;addressId&quot;) Long id) {" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/AddressController.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="39" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/controller/AddressController.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/service/IUserService.java: package com.hmall.user.service;&#10;import com.baomidou.mybatisplus.extension.service.IService;&#10;import com.hmall.user.domin.dto.LoginFormDTO;&#10;import com.hmall.user.domin.po.User;&#10;import com.hmall.user.domin.vo.UserLoginVO;&#10;/**&#10; * &lt;p&gt;&#10; * 用户表 服务类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; * @since 2023-05-05&#10; */&#10;public interface IUserService extends IService&lt;User&gt; {&#10;    UserLoginVO login(LoginFormDTO loginFormDTO);&#10;    void deductMoney(String pw, Integer totalFee);&#10;}" />
                      <option name="filePath" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/service/IUserService.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="21" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="user-service/src/main/java/com/hmall/user/service/IUserService.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: &#9;at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]&#10;&#9;... 14 common frames omitted&#10;Caused by: com.alibaba.nacos.api.exception.NacosException: Request nacos server failed: &#10;&#9;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:290) ~[nacos-client-2.0.4.jar:na]&#10;&#9;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:129) ~[nacos-client-2.0.4.jar:na]&#10;&#9;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:115) ~[nacos-client-2.0.4.jar:na]&#10;&#9;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:94) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="1084" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1078" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/service/impl/UserServiceImpl.java: package com.hmall.user.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.exception.ForbiddenException;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.user.config.JwtProperties;&#10;import com.hmall.user.domin.dto.LoginFormDTO;&#10;import com.hmall.user.domin.po.User;&#10;import com.hmall.user.domin.vo.UserLoginVO;&#10;import com.hmall.user.enums.UserStatus;&#10;import com.hmall.user.mapper.UserMapper;&#10;import com.hmall.user.service.IUserService;&#10;import com.hmall.user.utils.JwtTool;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.util.Assert;&#10;/**&#10; * &lt;p&gt;&#10; * 用户表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor" />
                      <option name="filePath" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/service/impl/UserServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="34" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="user-service/src/main/java/com/hmall/user/service/impl/UserServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[na:na]&#10;at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[na:na]&#10;at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500) ~[na:na]&#10;at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481) ~[na:na]&#10;at com.alibaba.nacos.api.naming.NamingFactory.createNamingService(NamingFactory.java:59) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="44" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="38" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.createNewNamingService(NacosServiceManager.java:99) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.buildNamingService(NacosServiceManager.java:90) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.getNamingService(NacosServiceManager.java:46) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.start(NacosWatch.java:130) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="126" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="122" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.createNewNamingService(NacosServiceManager.java:99) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.buildNamingService(NacosServiceManager.java:90) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.getNamingService(NacosServiceManager.java:46) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.start(NacosWatch.java:130) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="204" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="200" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.createNewNamingService(NacosServiceManager.java:99) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.buildNamingService(NacosServiceManager.java:90) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.getNamingService(NacosServiceManager.java:46) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.stop(NacosWatch.java:173) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="715" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="711" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doSubscribe(NamingGrpcClientProxy.java:230) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.subscribe(NamingGrpcClientProxy.java:215) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.subscribe(NamingClientProxyDelegate.java:147) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.subscribe(NacosNamingService.java:393) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.start(NacosWatch.java:132) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="376" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="371" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.init(NacosNamingService.java:95) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.&lt;init&gt;(NacosNamingService.java:81) ~[nacos-client-2.0.4.jar:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[na:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="627" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="621" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.init(NacosNamingService.java:95) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.&lt;init&gt;(NacosNamingService.java:81) ~[nacos-client-2.0.4.jar:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[na:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="785" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="779" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/service/impl/AddressServiceImpl.java: package com.hmall.user.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.user.domin.po.Address;&#10;import com.hmall.user.mapper.AddressMapper;&#10;import com.hmall.user.service.IAddressService;&#10;import org.springframework.stereotype.Service;&#10;/**&#10; * &lt;p&gt;&#10; *  服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; * @since 2023-05-05&#10; */&#10;@Service&#10;public class AddressServiceImpl extends ServiceImpl&lt;AddressMapper, Address&gt; implements IAddressService {&#10;}" />
                      <option name="filePath" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/service/impl/AddressServiceImpl.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="21" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="user-service/src/main/java/com/hmall/user/service/impl/AddressServiceImpl.java" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.3.jar:3.1.3]&#10;at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.3.jar:3.1.3]&#10;at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.3.jar:3.1.3]&#10;at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.3.jar:3.1.3]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="518" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="514" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.init(NacosNamingService.java:95) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.&lt;init&gt;(NacosNamingService.java:81) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="37" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="32" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.serverCheck(GrpcClient.java:148) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.connectToServer(GrpcClient.java:264) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="113" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="108" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.serverCheck(GrpcClient.java:148) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.connectToServer(GrpcClient.java:264) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="191" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="186" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.serverCheck(GrpcClient.java:148) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.connectToServer(GrpcClient.java:264) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="filePath" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="702" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="697" />
                        </Range>
                      </option>
                      <option name="relativePath" value="logs/item-service/spring.log" />
                    </CodebaseContextVariableValue>
                    <CodebaseContextVariableValue>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/enums/PayStatus.java: package com.hmall.enums;&#10;import lombok.Getter;&#10;@Getter&#10;public enum PayStatus {&#10;    NOT_COMMIT(0, &quot;未提交&quot;),&#10;    WAIT_BUYER_PAY(1, &quot;待支付&quot;),&#10;    TRADE_CLOSED(2, &quot;已关闭&quot;),&#10;    TRADE_SUCCESS(3, &quot;支付成功&quot;),&#10;    TRADE_FINISHED(3, &quot;支付成功&quot;),&#10;    ;&#10;    private final int value;&#10;    private final String desc;&#10;    PayStatus(int value, String desc) {&#10;        this.value = value;&#10;        this.desc = desc;&#10;    }&#10;    public boolean equalsValue(Integer value){&#10;        if (value == null) {&#10;            return false;&#10;        }&#10;        return getValue() == value;&#10;    }&#10;}" />
                      <option name="filePath" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/enums/PayStatus.java" />
                      <option name="range">
                        <Range>
                          <option name="endColumn" value="1" />
                          <option name="endLine" value="27" />
                          <option name="startColumn" value="1" />
                          <option name="startLine" value="1" />
                        </Range>
                      </option>
                      <option name="relativePath" value="hm-service/src/main/java/com/hmall/enums/PayStatus.java" />
                    </CodebaseContextVariableValue>
                  </list>
                </option>
                <option name="codebaseReferences">
                  <list>
                    <KnowledgeReference>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/controller/UserController.java: package com.hmall.user.controller;&#10;import com.hmall.user.domin.dto.LoginFormDTO;&#10;import com.hmall.user.domin.vo.UserLoginVO;&#10;import com.hmall.user.service.IUserService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiImplicitParam;&#10;import io.swagger.annotations.ApiImplicitParams;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.validation.annotation.Validated;&#10;import org.springframework.web.bind.annotation.*;&#10;@Api(tags = &quot;用户相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/users&quot;)&#10;@RequiredArgsConstructor&#10;public class UserController {&#10;    private final IUserService userService;&#10;    @ApiOperation(&quot;用户登录接口&quot;)&#10;    @PostMapping(&quot;login&quot;)&#10;    public UserLoginVO login(@RequestBody @Validated LoginFormDTO loginFormDTO){&#10;        return userService.login(loginFormDTO);&#10;    }&#10;    @ApiOperation(&quot;扣减余额&quot;)&#10;    @ApiImplicitParams({&#10;            @ApiImplicitParam(name = &quot;pw&quot;, value = &quot;支付密码&quot;),&#10;            @ApiImplicitParam(name = &quot;amount&quot;, value = &quot;支付金额&quot;)&#10;    })&#10;    @PutMapping(&quot;/money/deduct&quot;)&#10;    public void deductMoney(@RequestParam(&quot;pw&quot;) String pw,@RequestParam(&quot;amount&quot;) Integer amount){&#10;        userService.deductMoney(pw, amount);&#10;    }&#10;}" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="37" />
                          <option name="fileName" value="user-service/src/main/java/com/hmall/user/controller/UserController.java" />
                          <option name="source" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/controller/UserController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="cart-service/src/main/java/com/hmall/cart/controller/CartController.java: package com.hmall.cart.controller;&#10;import com.hmall.cart.domin.dto.CartFormDTO;&#10;import com.hmall.cart.domin.po.Cart;&#10;import com.hmall.cart.domin.vo.CartVO;&#10;import com.hmall.cart.service.ICartService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiImplicitParam;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.apache.ibatis.annotations.Param;&#10;import org.springframework.web.bind.annotation.*;&#10;import javax.validation.Valid;&#10;import java.util.List;&#10;@Api(tags = &quot;购物车相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/carts&quot;)&#10;@RequiredArgsConstructor&#10;public class CartController {&#10;    private final ICartService cartService;&#10;    @ApiOperation(&quot;添加商品到购物车&quot;)&#10;    @PostMapping&#10;    public void addItem2Cart(@Valid @RequestBody CartFormDTO cartFormDTO){&#10;        cartService.addItem2Cart(cartFormDTO);&#10;    }&#10;    @ApiOperation(&quot;更新购物车数据&quot;)&#10;    @PutMapping&#10;    public void updateCart(@RequestBody Cart cart){&#10;        cartService.updateById(cart);&#10;    }&#10;    @ApiOperation(&quot;删除购物车中商品&quot;)&#10;    @DeleteMapping(&quot;{id}&quot;)&#10;    public void deleteCartItem(@Param (&quot;购物车条目id&quot;)@PathVariable(&quot;id&quot;) Long id){&#10;        cartService.removeById(id);" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="40" />
                          <option name="fileName" value="cart-service/src/main/java/com/hmall/cart/controller/CartController.java" />
                          <option name="source" value="$PROJECT_DIR$/cart-service/src/main/java/com/hmall/cart/controller/CartController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/CartController.java: package com.hmall.controller;&#10;import com.hmall.domain.dto.CartFormDTO;&#10;import com.hmall.domain.po.Cart;&#10;import com.hmall.domain.vo.CartVO;&#10;import com.hmall.service.ICartService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiImplicitParam;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.apache.ibatis.annotations.Param;&#10;import org.springframework.web.bind.annotation.*;&#10;import javax.validation.Valid;&#10;import java.util.List;&#10;@Api(tags = &quot;购物车相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/carts&quot;)&#10;@RequiredArgsConstructor&#10;public class CartController {&#10;    private final ICartService cartService;&#10;    @ApiOperation(&quot;添加商品到购物车&quot;)&#10;    @PostMapping&#10;    public void addItem2Cart(@Valid @RequestBody CartFormDTO cartFormDTO){&#10;        cartService.addItem2Cart(cartFormDTO);&#10;    }&#10;    @ApiOperation(&quot;更新购物车数据&quot;)&#10;    @PutMapping&#10;    public void updateCart(@RequestBody Cart cart){&#10;        cartService.updateById(cart);&#10;    }&#10;    @ApiOperation(&quot;删除购物车中商品&quot;)&#10;    @DeleteMapping(&quot;{id}&quot;)&#10;    public void deleteCartItem(@Param (&quot;购物车条目id&quot;)@PathVariable(&quot;id&quot;) Long id){&#10;        cartService.removeById(id);&#10;    }&#10;    @ApiOperation(&quot;查询购物车列表&quot;)&#10;    @GetMapping" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="44" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/controller/CartController.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/CartController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="item-service/src/main/java/com/hmall/item/controller/ItemController.java: package com.hmall.item.controller;&#10;import com.baomidou.mybatisplus.extension.plugins.pagination.Page;&#10;import com.hmall.common.domain.PageDTO;&#10;import com.hmall.common.domain.PageQuery;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.item.domin.dto.ItemDTO;&#10;import com.hmall.item.domin.dto.OrderDetailDTO;&#10;import com.hmall.item.domin.po.Item;&#10;import com.hmall.item.service.IItemService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.*;&#10;import java.util.List;&#10;@Api(tags = &quot;商品管理相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/items&quot;)&#10;@RequiredArgsConstructor&#10;public class ItemController {&#10;    private final IItemService itemService;&#10;    @ApiOperation(&quot;分页查询商品&quot;)&#10;    @GetMapping(&quot;/page&quot;)&#10;    public PageDTO&lt;ItemDTO&gt; queryItemByPage(PageQuery query) {&#10;        // 1.分页查询&#10;        Page&lt;Item&gt; result = itemService.page(query.toMpPage(&quot;update_time&quot;, false));&#10;        // 2.封装并返回&#10;        return PageDTO.of(result, ItemDTO.class);&#10;    }&#10;    @ApiOperation(&quot;根据id批量查询商品&quot;)" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="36" />
                          <option name="fileName" value="item-service/src/main/java/com/hmall/item/controller/ItemController.java" />
                          <option name="source" value="$PROJECT_DIR$/item-service/src/main/java/com/hmall/item/controller/ItemController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/OrderServiceImpl.java: public class OrderServiceImpl extends ServiceImpl&lt;OrderMapper, Order&gt; implements IOrderService {&#10;    private final IItemService itemService;&#10;    private final IOrderDetailService detailService;&#10;    private final ICartService cartService;&#10;    @Override&#10;    @Transactional&#10;    public Long createOrder(OrderFormDTO orderFormDTO) {&#10;        // 1.订单数据&#10;        Order order = new Order();&#10;        // 1.1.查询商品&#10;        List&lt;OrderDetailDTO&gt; detailDTOS = orderFormDTO.getDetails();&#10;        // 1.2.获取商品id和数量的Map&#10;        Map&lt;Long, Integer&gt; itemNumMap = detailDTOS.stream()&#10;                .collect(Collectors.toMap(OrderDetailDTO::getItemId, OrderDetailDTO::getNum));&#10;        Set&lt;Long&gt; itemIds = itemNumMap.keySet();&#10;        // 1.3.查询商品&#10;        List&lt;ItemDTO&gt; items = itemService.queryItemByIds(itemIds);&#10;        if (items == null || items.size() &lt; itemIds.size()) {&#10;            throw new BadRequestException(&quot;商品不存在&quot;);&#10;        }&#10;        // 1.4.基于商品价格、购买数量计算商品总价：totalFee&#10;        int total = 0;&#10;        for (ItemDTO item : items) {&#10;            total += item.getPrice() * itemNumMap.get(item.getId());&#10;        }&#10;        order.setTotalFee(total);&#10;        // 1.5.其它属性&#10;        order.setPaymentType(orderFormDTO.getPaymentType());&#10;        order.setUserId(UserContext.getUser());" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="67" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/service/impl/OrderServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/OrderServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="37" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java: package com.hmall.service.impl;&#10;import com.baomidou.mybatisplus.core.toolkit.IdWorker;&#10;import com.baomidou.mybatisplus.core.toolkit.StringUtils;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.domain.dto.PayApplyDTO;&#10;import com.hmall.domain.dto.PayOrderFormDTO;&#10;import com.hmall.domain.po.Order;&#10;import com.hmall.domain.po.PayOrder;&#10;import com.hmall.enums.PayStatus;&#10;import com.hmall.mapper.PayOrderMapper;&#10;import com.hmall.service.IOrderService;&#10;import com.hmall.service.IPayOrderService;&#10;import com.hmall.service.IUserService;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;import java.time.LocalDateTime;&#10;/**&#10; * &lt;p&gt;&#10; * 支付订单 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; * @since 2023-05-16&#10; */&#10;@Service&#10;@RequiredArgsConstructor&#10;public class PayOrderServiceImpl extends ServiceImpl&lt;PayOrderMapper, PayOrder&gt; implements IPayOrderService {" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="34" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/SearchController.java: package com.hmall.controller;&#10;import cn.hutool.core.util.StrUtil;&#10;import com.baomidou.mybatisplus.extension.plugins.pagination.Page;&#10;import com.hmall.common.domain.PageDTO;&#10;import com.hmall.domain.dto.ItemDTO;&#10;import com.hmall.domain.po.Item;&#10;import com.hmall.domain.query.ItemPageQuery;&#10;import com.hmall.service.IItemService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;@Api(tags = &quot;搜索相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/search&quot;)&#10;@RequiredArgsConstructor&#10;public class SearchController {&#10;    private final IItemService itemService;&#10;    @ApiOperation(&quot;搜索商品&quot;)&#10;    @GetMapping(&quot;/list&quot;)&#10;    public PageDTO&lt;ItemDTO&gt; search(ItemPageQuery query) {&#10;        // 分页查询&#10;        Page&lt;Item&gt; result = itemService.lambdaQuery()&#10;                .like(StrUtil.isNotBlank(query.getKey()), Item::getName, query.getKey())" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="31" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/controller/SearchController.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/SearchController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/UserServiceImpl.java: package com.hmall.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.exception.ForbiddenException;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.config.JwtProperties;&#10;import com.hmall.domain.dto.LoginFormDTO;&#10;import com.hmall.domain.po.User;&#10;import com.hmall.domain.vo.UserLoginVO;&#10;import com.hmall.enums.UserStatus;&#10;import com.hmall.mapper.UserMapper;&#10;import com.hmall.service.IUserService;&#10;import com.hmall.utils.JwtTool;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.util.Assert;&#10;/**&#10; * &lt;p&gt;&#10; * 用户表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class UserServiceImpl extends ServiceImpl&lt;UserMapper, User&gt; implements IUserService {&#10;    private final PasswordEncoder passwordEncoder;&#10;    private final JwtTool jwtTool;" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="36" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/service/impl/UserServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/UserServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java: private final IUserService userService;&#10;private final IOrderService orderService;&#10;@Override&#10;public String applyPayOrder(PayApplyDTO applyDTO) {&#10;    // 1.幂等性校验&#10;    PayOrder payOrder = checkIdempotent(applyDTO);&#10;    // 2.返回结果&#10;    return payOrder.getId().toString();&#10;}&#10;@Override&#10;@Transactional&#10;public void tryPayOrderByBalance(PayOrderFormDTO payOrderFormDTO) {&#10;    // 1.查询支付单&#10;    PayOrder po = getById(payOrderFormDTO.getId());&#10;    // 2.判断状态&#10;    if(!PayStatus.WAIT_BUYER_PAY.equalsValue(po.getStatus())){&#10;        // 订单不是未支付，状态异常&#10;        throw new BizIllegalException(&quot;交易已支付或关闭！&quot;);&#10;    }&#10;    // 3.尝试扣减余额&#10;    userService.deductMoney(payOrderFormDTO.getPw(), po.getAmount());&#10;    // 4.修改支付单状态&#10;    boolean success = markPayOrderSuccess(payOrderFormDTO.getId(), LocalDateTime.now());&#10;    if (!success) {&#10;        throw new BizIllegalException(&quot;交易已支付或关闭！&quot;);&#10;    }&#10;    // 5.修改订单状态&#10;    Order order = new Order();&#10;    order.setId(po.getBizOrderNo());&#10;    order.setStatus(2);&#10;    order.setPayTime(LocalDateTime.now());&#10;    orderService.updateById(order);&#10;}&#10;public boolean markPayOrderSuccess(Long id, LocalDateTime successTime) {&#10;    return lambdaUpdate()&#10;            .set(PayOrder::getStatus, PayStatus.TRADE_SUCCESS.getValue())" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="75" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/PayOrderServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="36" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/service/impl/ItemServiceImpl.java: package com.hmall.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.domain.dto.ItemDTO;&#10;import com.hmall.domain.dto.OrderDetailDTO;&#10;import com.hmall.domain.po.Item;&#10;import com.hmall.mapper.ItemMapper;&#10;import com.hmall.service.IItemService;&#10;import org.springframework.stereotype.Service;&#10;import java.util.Collection;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; * 商品表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Service&#10;public class ItemServiceImpl extends ServiceImpl&lt;ItemMapper, Item&gt; implements IItemService {&#10;    @Override&#10;    public void deductStock(List&lt;OrderDetailDTO&gt; items) {&#10;        String sqlStatement = &quot;com.hmall.mapper.ItemMapper.updateStock&quot;;&#10;        boolean r = false;&#10;        try {&#10;            r = executeBatch(items, (sqlSession, entity) -&gt; sqlSession.update(sqlStatement, entity));&#10;        } catch (Exception e) {&#10;            throw new BizIllegalException(&quot;更新库存异常，可能是库存不足!&quot;, e);&#10;        }&#10;        if (!r) {&#10;            throw new BizIllegalException(&quot;库存不足！&quot;);&#10;        }" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="37" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/service/impl/ItemServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/service/impl/ItemServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/ItemController.java: package com.hmall.controller;&#10;import com.baomidou.mybatisplus.extension.plugins.pagination.Page;&#10;import com.hmall.common.domain.PageDTO;&#10;import com.hmall.common.domain.PageQuery;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.domain.dto.ItemDTO;&#10;import com.hmall.domain.dto.OrderDetailDTO;&#10;import com.hmall.domain.po.Item;&#10;import com.hmall.service.IItemService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.*;&#10;import java.util.List;&#10;@Api(tags = &quot;商品管理相关接口&quot;)&#10;@RestController&#10;@RequestMapping(&quot;/items&quot;)&#10;@RequiredArgsConstructor&#10;public class ItemController {&#10;    private final IItemService itemService;&#10;    @ApiOperation(&quot;分页查询商品&quot;)&#10;    @GetMapping(&quot;/page&quot;)&#10;    public PageDTO&lt;ItemDTO&gt; queryItemByPage(PageQuery query) {&#10;        // 1.分页查询&#10;        Page&lt;Item&gt; result = itemService.page(query.toMpPage(&quot;update_time&quot;, false));&#10;        // 2.封装并返回&#10;        return PageDTO.of(result, ItemDTO.class);&#10;    }&#10;    @ApiOperation(&quot;根据id批量查询商品&quot;)&#10;    @GetMapping" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="37" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/controller/ItemController.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/ItemController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-common/src/main/java/com/hmall/common/utils/CookieBuilder.java:         Cookie cookie = new Cookie(name, URLEncoder.encode(value, charset));&#10;        if(StrUtil.isNotBlank(domain)) {&#10;            cookie.setDomain(domain);&#10;        }else if (request != null) {&#10;            String serverName = request.getServerName();&#10;            serverName = StrUtil.subAfter(serverName, &quot;.&quot;, false);&#10;            cookie.setDomain(&quot;.&quot; + serverName);&#10;        }&#10;        cookie.setHttpOnly(httpOnly);&#10;        cookie.setMaxAge(maxAge);&#10;        cookie.setPath(path);&#10;        log.debug(&quot;生成cookie，编码方式:{}，【{}={}，domain:{};maxAge={};path={};httpOnly={}】&quot;,&#10;                charset.name(), name, value, domain, maxAge, path, httpOnly);&#10;        response.addCookie(cookie);&#10;    }&#10;    /**&#10;     * 利用UTF-8对cookie值解码，避免中文乱码问题&#10;     * @param cookieValue cookie原始值&#10;     * @return 解码后的值&#10;     */&#10;    public String decode(String cookieValue){&#10;        return URLDecoder.decode(cookieValue, charset);&#10;    }&#10;}" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="67" />
                          <option name="fileName" value="hm-common/src/main/java/com/hmall/common/utils/CookieBuilder.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-common/src/main/java/com/hmall/common/utils/CookieBuilder.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="43" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/controller/AddressController.java: package com.hmall.user.controller;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.common.utils.CollUtils;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.user.domin.dto.AddressDTO;&#10;import com.hmall.user.domin.po.Address;&#10;import com.hmall.user.service.IAddressService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import io.swagger.annotations.ApiParam;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; *  前端控制器&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@RestController&#10;@RequestMapping(&quot;/addresses&quot;)&#10;@RequiredArgsConstructor&#10;@Api(tags = &quot;收货地址管理接口&quot;)&#10;public class AddressController {&#10;    private final IAddressService addressService;&#10;    @ApiOperation(&quot;根据id查询地址&quot;)&#10;    @GetMapping(&quot;{addressId}&quot;)" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="38" />
                          <option name="fileName" value="user-service/src/main/java/com/hmall/user/controller/AddressController.java" />
                          <option name="source" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/controller/AddressController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="item-service/src/main/java/com/hmall/item/service/impl/ItemServiceImpl.java: package com.hmall.item.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.item.domin.dto.ItemDTO;&#10;import com.hmall.item.domin.dto.OrderDetailDTO;&#10;import com.hmall.item.domin.po.Item;&#10;import com.hmall.item.mapper.ItemMapper;&#10;import com.hmall.item.service.IItemService;&#10;import org.springframework.stereotype.Service;&#10;import java.util.Collection;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; * 商品表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Service&#10;public class ItemServiceImpl extends ServiceImpl&lt;ItemMapper, Item&gt; implements IItemService {&#10;    @Override&#10;    public void deductStock(List&lt;OrderDetailDTO&gt; items) {&#10;        String sqlStatement = &quot;com.hmall.item.mapper.ItemMapper.updateStock&quot;;&#10;        boolean r = false;&#10;        try {&#10;            r = executeBatch(items, (sqlSession, entity) -&gt; sqlSession.update(sqlStatement, entity));&#10;        } catch (Exception e) {&#10;            throw new BizIllegalException(&quot;更新库存异常，可能是库存不足!&quot;, e);&#10;        }" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="34" />
                          <option name="fileName" value="item-service/src/main/java/com/hmall/item/service/impl/ItemServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/item-service/src/main/java/com/hmall/item/service/impl/ItemServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/controller/AddressController.java: package com.hmall.controller;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.utils.BeanUtils;&#10;import com.hmall.common.utils.CollUtils;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.domain.dto.AddressDTO;&#10;import com.hmall.domain.po.Address;&#10;import com.hmall.service.IAddressService;&#10;import io.swagger.annotations.Api;&#10;import io.swagger.annotations.ApiOperation;&#10;import io.swagger.annotations.ApiParam;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;import java.util.List;&#10;/**&#10; * &lt;p&gt;&#10; *  前端控制器&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@RestController&#10;@RequestMapping(&quot;/addresses&quot;)&#10;@RequiredArgsConstructor&#10;@Api(tags = &quot;收货地址管理接口&quot;)&#10;public class AddressController {&#10;    private final IAddressService addressService;&#10;    @ApiOperation(&quot;根据id查询地址&quot;)&#10;    @GetMapping(&quot;{addressId}&quot;)&#10;    public AddressDTO findAddressById(@ApiParam(&quot;地址id&quot;) @PathVariable(&quot;addressId&quot;) Long id) {" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="39" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/controller/AddressController.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/controller/AddressController.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/service/IUserService.java: package com.hmall.user.service;&#10;import com.baomidou.mybatisplus.extension.service.IService;&#10;import com.hmall.user.domin.dto.LoginFormDTO;&#10;import com.hmall.user.domin.po.User;&#10;import com.hmall.user.domin.vo.UserLoginVO;&#10;/**&#10; * &lt;p&gt;&#10; * 用户表 服务类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; * @since 2023-05-05&#10; */&#10;public interface IUserService extends IService&lt;User&gt; {&#10;    UserLoginVO login(LoginFormDTO loginFormDTO);&#10;    void deductMoney(String pw, Integer totalFee);&#10;}" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="21" />
                          <option name="fileName" value="user-service/src/main/java/com/hmall/user/service/IUserService.java" />
                          <option name="source" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/service/IUserService.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: &#9;at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]&#10;&#9;... 14 common frames omitted&#10;Caused by: com.alibaba.nacos.api.exception.NacosException: Request nacos server failed: &#10;&#9;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:290) ~[nacos-client-2.0.4.jar:na]&#10;&#9;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:129) ~[nacos-client-2.0.4.jar:na]&#10;&#9;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:115) ~[nacos-client-2.0.4.jar:na]&#10;&#9;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:94) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="1084" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1078" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/service/impl/UserServiceImpl.java: package com.hmall.user.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.common.exception.BadRequestException;&#10;import com.hmall.common.exception.BizIllegalException;&#10;import com.hmall.common.exception.ForbiddenException;&#10;import com.hmall.common.utils.UserContext;&#10;import com.hmall.user.config.JwtProperties;&#10;import com.hmall.user.domin.dto.LoginFormDTO;&#10;import com.hmall.user.domin.po.User;&#10;import com.hmall.user.domin.vo.UserLoginVO;&#10;import com.hmall.user.enums.UserStatus;&#10;import com.hmall.user.mapper.UserMapper;&#10;import com.hmall.user.service.IUserService;&#10;import com.hmall.user.utils.JwtTool;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.util.Assert;&#10;/**&#10; * &lt;p&gt;&#10; * 用户表 服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; */&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="34" />
                          <option name="fileName" value="user-service/src/main/java/com/hmall/user/service/impl/UserServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/service/impl/UserServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[na:na]&#10;at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[na:na]&#10;at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500) ~[na:na]&#10;at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481) ~[na:na]&#10;at com.alibaba.nacos.api.naming.NamingFactory.createNamingService(NamingFactory.java:59) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="44" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="38" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.createNewNamingService(NacosServiceManager.java:99) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.buildNamingService(NacosServiceManager.java:90) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.getNamingService(NacosServiceManager.java:46) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.start(NacosWatch.java:130) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="126" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="122" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.createNewNamingService(NacosServiceManager.java:99) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.buildNamingService(NacosServiceManager.java:90) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.getNamingService(NacosServiceManager.java:46) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.start(NacosWatch.java:130) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="204" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="200" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.api.NacosFactory.createNamingService(NacosFactory.java:77) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.createNewNamingService(NacosServiceManager.java:99) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.buildNamingService(NacosServiceManager.java:90) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.NacosServiceManager.getNamingService(NacosServiceManager.java:46) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.stop(NacosWatch.java:173) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="715" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="711" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doSubscribe(NamingGrpcClientProxy.java:230) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.subscribe(NamingGrpcClientProxy.java:215) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.subscribe(NamingClientProxyDelegate.java:147) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.subscribe(NacosNamingService.java:393) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.cloud.nacos.discovery.NacosWatch.start(NacosWatch.java:132) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="376" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="371" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.init(NacosNamingService.java:95) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.&lt;init&gt;(NacosNamingService.java:81) ~[nacos-client-2.0.4.jar:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[na:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="627" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="621" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.init(NacosNamingService.java:95) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.&lt;init&gt;(NacosNamingService.java:81) ~[nacos-client-2.0.4.jar:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:na]&#10;at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[na:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="785" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="779" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="user-service/src/main/java/com/hmall/user/service/impl/AddressServiceImpl.java: package com.hmall.user.service.impl;&#10;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;&#10;import com.hmall.user.domin.po.Address;&#10;import com.hmall.user.mapper.AddressMapper;&#10;import com.hmall.user.service.IAddressService;&#10;import org.springframework.stereotype.Service;&#10;/**&#10; * &lt;p&gt;&#10; *  服务实现类&#10; * &lt;/p&gt;&#10; *&#10; * @author 虎哥&#10; * @since 2023-05-05&#10; */&#10;@Service&#10;public class AddressServiceImpl extends ServiceImpl&lt;AddressMapper, Address&gt; implements IAddressService {&#10;}" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="21" />
                          <option name="fileName" value="user-service/src/main/java/com/hmall/user/service/impl/AddressServiceImpl.java" />
                          <option name="source" value="$PROJECT_DIR$/user-service/src/main/java/com/hmall/user/service/impl/AddressServiceImpl.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.3.jar:3.1.3]&#10;at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.4.0.jar:2021.0.4.0]&#10;at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.3.jar:3.1.3]&#10;at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.3.jar:3.1.3]&#10;at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.3.jar:3.1.3]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="518" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="514" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.init(NacosNamingService.java:95) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.NacosNamingService.&lt;init&gt;(NacosNamingService.java:81) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="37" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="32" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.serverCheck(GrpcClient.java:148) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.connectToServer(GrpcClient.java:264) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="113" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="108" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.serverCheck(GrpcClient.java:148) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.connectToServer(GrpcClient.java:264) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="191" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="186" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="logs/item-service/spring.log: at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.serverCheck(GrpcClient.java:148) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.grpc.GrpcClient.connectToServer(GrpcClient.java:264) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.common.remote.client.RpcClient.start(RpcClient.java:390) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.start(NamingGrpcClientProxy.java:96) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.&lt;init&gt;(NamingGrpcClientProxy.java:89) ~[nacos-client-2.0.4.jar:na]&#10;at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.&lt;init&gt;(NamingClientProxyDelegate.java:76) ~[nacos-client-2.0.4.jar:na]" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="702" />
                          <option name="fileName" value="logs/item-service/spring.log" />
                          <option name="source" value="$PROJECT_DIR$/logs/item-service/spring.log" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="697" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                    <KnowledgeReference>
                      <option name="chunk" value="hm-service/src/main/java/com/hmall/enums/PayStatus.java: package com.hmall.enums;&#10;import lombok.Getter;&#10;@Getter&#10;public enum PayStatus {&#10;    NOT_COMMIT(0, &quot;未提交&quot;),&#10;    WAIT_BUYER_PAY(1, &quot;待支付&quot;),&#10;    TRADE_CLOSED(2, &quot;已关闭&quot;),&#10;    TRADE_SUCCESS(3, &quot;支付成功&quot;),&#10;    TRADE_FINISHED(3, &quot;支付成功&quot;),&#10;    ;&#10;    private final int value;&#10;    private final String desc;&#10;    PayStatus(int value, String desc) {&#10;        this.value = value;&#10;        this.desc = desc;&#10;    }&#10;    public boolean equalsValue(Integer value){&#10;        if (value == null) {&#10;            return false;&#10;        }&#10;        return getValue() == value;&#10;    }&#10;}" />
                      <option name="metadata">
                        <KnowledgeReferenceMetadata>
                          <option name="endPos" value="27" />
                          <option name="fileName" value="hm-service/src/main/java/com/hmall/enums/PayStatus.java" />
                          <option name="source" value="$PROJECT_DIR$/hm-service/src/main/java/com/hmall/enums/PayStatus.java" />
                          <option name="sourceType" value="code" />
                          <option name="startPos" value="1" />
                        </KnowledgeReferenceMetadata>
                      </option>
                    </KnowledgeReference>
                  </list>
                </option>
                <option name="command" value="" />
                <option name="conversationId" value="01977c7c08897bbead8f576ad3f0e7ec" />
                <option name="historyDocumentMap">
                  <map />
                </option>
                <option name="messageId" value="01977c7d87ce7bbead8f642b8ce38cf3" />
                <option name="question" value="xln.snzoo.gizwv.wlnrm中创建软件包kl" />
                <option name="rating" value="UNRATED" />
                <option name="referenceBeans">
                  <list />
                </option>
                <option name="status" value="SUCCESS" />
                <option name="variables">
                  <list>
                    <CodebaseVariable>
                      <option name="selectedPlaceHolder">
                        <Object />
                      </option>
                      <option name="selectedVariable">
                        <Object />
                      </option>
                    </CodebaseVariable>
                  </list>
                </option>
              </Turn>
            </list>
          </option>
          <option name="updateTime" value="1750140305898" />
        </Conversation>
      </list>
    </option>
  </component>
</project>